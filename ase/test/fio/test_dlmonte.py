# tests of the dlmonte I/O
from ase.io.dlmonte import iread_dlm_history, read_dlm, read_dlm_history
from io import StringIO

import numpy as np


# Test CONFIG with a single molecule
config2 = StringIO("""IRMOF1
0 1
25.832 0.0 0.0
0.0 25.832 0.0
0.0 0.0 25.832
NUMMOL 1 1000 1000
MOLECULE IRMOF1 424
Zn_S core
 7.57859 5.33741 5.33741 0
O_Zn core
 6.458 6.458 6.458 0
O_S core
 7.28127 5.63473 3.46226 0
C_S_1 core
 6.458 6.458 2.87613 0
C_S_0 core
 6.458 6.458 1.39054 0
C_S_0 core
 7.30736 5.60864 0.69411 0
H_S core
 7.87721 5.03879 1.15831 0
Zn_S core
 18.25341 20.49459 5.33741 0
O_Zn core
 19.374 19.374 6.458 0
O_S core
 18.55073 20.19727 3.46226 0
C_S_1 core
 19.374 19.374 2.87613 0
C_S_0 core
 19.374 19.374 1.39054 0
C_S_0 core
 18.52464 20.22336 0.69411 0
H_S core
 17.95479 20.79321 1.15831 0
Zn_S core
 18.25341 5.33741 20.49459 0
O_Zn core
 19.374 6.458 19.374 0
O_S core
 18.55073 5.63473 22.36974 0
C_S_1 core
 19.374 6.458 22.95587 0
C_S_0 core
 19.374 6.458 24.44146 0
C_S_0 core
 18.52464 5.60864 25.13789 0
H_S core
 17.95479 5.03879 24.67369 0
Zn_S core
 7.57859 20.49459 20.49459 0
O_Zn core
 6.458 19.374 19.374 0
O_S core
 7.28127 20.19727 22.36974 0
C_S_1 core
 6.458 19.374 22.95587 0
C_S_0 core
 6.458 19.374 24.44146 0
C_S_0 core
 7.30736 20.22336 25.13789 0
H_S core
 7.87721 20.79321 24.67369 0
Zn_S core
 5.33741 7.57859 5.33741 0
O_S core
 3.46226 7.28127 5.63473 0
C_S_1 core
 2.87613 6.458 6.458 0
C_S_0 core
 1.39054 6.458 6.458 0
C_S_0 core
 0.69411 7.30736 5.60864 0
H_S core
 1.15831 7.87721 5.03879 0
Zn_S core
 5.33741 18.25341 20.49459 0
O_S core
 3.46226 18.55073 20.19727 0
C_S_1 core
 2.87613 19.374 19.374 0
C_S_0 core
 1.39054 19.374 19.374 0
C_S_0 core
 0.69411 18.52464 20.22336 0
H_S core
 1.15831 17.95479 20.79321 0
Zn_S core
 20.49459 18.25341 5.33741 0
O_S core
 22.36974 18.55073 5.63473 0
C_S_1 core
 22.95587 19.374 6.458 0
C_S_0 core
 24.44146 19.374 6.458 0
C_S_0 core
 25.13789 18.52464 5.60864 0
H_S core
 24.67369 17.95479 5.03879 0
Zn_S core
 20.49459 7.57859 20.49459 0
O_S core
 22.36974 7.28127 20.19727 0
C_S_1 core
 22.95587 6.458 19.374 0
C_S_0 core
 24.44146 6.458 19.374 0
C_S_0 core
 25.13789 7.30736 20.22336 0
H_S core
 24.67369 7.87721 20.79321 0
Zn_S core
 5.33741 5.33741 7.57859 0
O_S core
 5.63473 3.46226 7.28127 0
C_S_1 core
 6.458 2.87613 6.458 0
C_S_0 core
 6.458 1.39054 6.458 0
C_S_0 core
 5.60864 0.69411 7.30736 0
H_S core
 5.03879 1.15831 7.87721 0
Zn_S core
 20.49459 5.33741 18.25341 0
O_S core
 20.19727 3.46226 18.55073 0
C_S_1 core
 19.374 2.87613 19.374 0
C_S_0 core
 19.374 1.39054 19.374 0
C_S_0 core
 20.22336 0.69411 18.52464 0
H_S core
 20.79321 1.15831 17.95479 0
Zn_S core
 5.33741 20.49459 18.25341 0
O_S core
 5.63473 22.36974 18.55073 0
C_S_1 core
 6.458 22.95587 19.374 0
C_S_0 core
 6.458 24.44146 19.374 0
C_S_0 core
 5.60864 25.13789 18.52464 0
H_S core
 5.03879 24.67369 17.95479 0
Zn_S core
 20.49459 20.49459 7.57859 0
O_S core
 20.19727 22.36974 7.28127 0
C_S_1 core
 19.374 22.95587 6.458 0
C_S_0 core
 19.374 24.44146 6.458 0
C_S_0 core
 20.22336 25.13789 7.30736 0
H_S core
 20.79321 24.67369 7.87721 0
Zn_S core
 5.33741 7.57859 20.49459 0
O_Zn core
 6.458 6.458 19.374 0
O_S core
 5.63473 7.28127 22.36974 0
C_S_1 core
 6.458 6.458 22.95587 0
C_S_0 core
 6.458 6.458 24.44146 0
C_S_0 core
 5.60864 7.30736 25.13789 0
H_S core
 5.03879 7.87721 24.67369 0
Zn_S core
 20.49459 18.25341 20.49459 0
O_Zn core
 19.374 19.374 19.374 0
O_S core
 20.19727 18.55073 22.36974 0
C_S_1 core
 19.374 19.374 22.95587 0
C_S_0 core
 19.374 19.374 24.44146 0
C_S_0 core
 20.22336 18.52464 25.13789 0
H_S core
 20.79321 17.95479 24.67369 0
Zn_S core
 5.33741 18.25341 5.33741 0
O_Zn core
 6.458 19.374 6.458 0
O_S core
 5.63473 18.55073 3.46226 0
C_S_1 core
 6.458 19.374 2.87613 0
C_S_0 core
 6.458 19.374 1.39054 0
C_S_0 core
 5.60864 18.52464 0.69411 0
H_S core
 5.03879 17.95479 1.15831 0
Zn_S core
 20.49459 7.57859 5.33741 0
O_Zn core
 19.374 6.458 6.458 0
O_S core
 20.19727 7.28127 3.46226 0
C_S_1 core
 19.374 6.458 2.87613 0
C_S_0 core
 19.374 6.458 1.39054 0
C_S_0 core
 20.22336 7.30736 0.69411 0
H_S core
 20.79321 7.87721 1.15831 0
Zn_S core
 7.57859 5.33741 20.49459 0
O_S core
 7.28127 3.46226 20.19727 0
C_S_1 core
 6.458 2.87613 19.374 0
C_S_0 core
 6.458 1.39054 19.374 0
C_S_0 core
 7.30736 0.69411 20.22336 0
H_S core
 7.87721 1.15831 20.79321 0
Zn_S core
 18.25341 5.33741 5.33741 0
O_S core
 18.55073 3.46226 5.63473 0
C_S_1 core
 19.374 2.87613 6.458 0
C_S_0 core
 19.374 1.39054 6.458 0
C_S_0 core
 18.52464 0.69411 5.60864 0
H_S core
 17.95479 1.15831 5.03879 0
Zn_S core
 18.25341 20.49459 20.49459 0
O_S core
 18.55073 22.36974 20.19727 0
C_S_1 core
 19.374 22.95587 19.374 0
C_S_0 core
 19.374 24.44146 19.374 0
C_S_0 core
 18.52464 25.13789 20.22336 0
H_S core
 17.95479 24.67369 20.79321 0
Zn_S core
 7.57859 20.49459 5.33741 0
O_S core
 7.28127 22.36974 5.63473 0
C_S_1 core
 6.458 22.95587 6.458 0
C_S_0 core
 6.458 24.44146 6.458 0
C_S_0 core
 7.30736 25.13789 5.60864 0
H_S core
 7.87721 24.67369 5.03879 0
Zn_S core
 5.33741 5.33741 18.25341 0
O_S core
 3.46226 5.63473 18.55073 0
C_S_1 core
 2.87613 6.458 19.374 0
C_S_0 core
 1.39054 6.458 19.374 0
C_S_0 core
 0.69411 5.60864 18.52464 0
H_S core
 1.15831 5.03879 17.95479 0
Zn_S core
 5.33741 20.49459 7.57859 0
O_S core
 3.46226 20.19727 7.28127 0
C_S_1 core
 2.87613 19.374 6.458 0
C_S_0 core
 1.39054 19.374 6.458 0
C_S_0 core
 0.69411 20.22336 7.30736 0
H_S core
 1.15831 20.79321 7.87721 0
Zn_S core
 20.49459 5.33741 7.57859 0
O_S core
 22.36974 5.63473 7.28127 0
C_S_1 core
 22.95587 6.458 6.458 0
C_S_0 core
 24.44146 6.458 6.458 0
C_S_0 core
 25.13789 5.60864 7.30736 0
H_S core
 24.67369 5.03879 7.87721 0
Zn_S core
 20.49459 20.49459 18.25341 0
O_S core
 22.36974 20.19727 18.55073 0
C_S_1 core
 22.95587 19.374 19.374 0
C_S_0 core
 24.44146 19.374 19.374 0
C_S_0 core
 25.13789 20.22336 18.52464 0
H_S core
 24.67369 20.79321 17.95479 0
O_S core
 18.55073 20.19727 22.36974 0
C_S_0 core
 18.52464 20.22336 25.13789 0
H_S core
 17.95479 20.79321 24.67369 0
O_S core
 7.28127 5.63473 22.36974 0
C_S_0 core
 7.30736 5.60864 25.13789 0
H_S core
 7.87721 5.03879 24.67369 0
O_S core
 7.28127 20.19727 3.46226 0
C_S_0 core
 7.30736 20.22336 0.69411 0
H_S core
 7.87721 20.79321 1.15831 0
O_S core
 18.55073 5.63473 3.46226 0
C_S_0 core
 18.52464 5.60864 0.69411 0
H_S core
 17.95479 5.03879 1.15831 0
O_S core
 22.36974 18.55073 20.19727 0
C_S_0 core
 25.13789 18.52464 20.22336 0
H_S core
 24.67369 17.95479 20.79321 0
O_S core
 22.36974 7.28127 5.63473 0
C_S_0 core
 25.13789 7.30736 5.60864 0
H_S core
 24.67369 7.87721 5.03879 0
O_S core
 3.46226 7.28127 20.19727 0
C_S_0 core
 0.69411 7.30736 20.22336 0
H_S core
 1.15831 7.87721 20.79321 0
O_S core
 3.46226 18.55073 5.63473 0
C_S_0 core
 0.69411 18.52464 5.60864 0
H_S core
 1.15831 17.95479 5.03879 0
O_S core
 20.19727 22.36974 18.55073 0
C_S_0 core
 20.22336 25.13789 18.52464 0
H_S core
 20.79321 24.67369 17.95479 0
O_S core
 5.63473 22.36974 7.28127 0
C_S_0 core
 5.60864 25.13789 7.30736 0
H_S core
 5.03879 24.67369 7.87721 0
O_S core
 20.19727 3.46226 7.28127 0
C_S_0 core
 20.22336 0.69411 7.30736 0
H_S core
 20.79321 1.15831 7.87721 0
O_S core
 5.63473 3.46226 18.55073 0
C_S_0 core
 5.60864 0.69411 18.52464 0
H_S core
 5.03879 1.15831 17.95479 0
O_S core
 20.19727 18.55073 3.46226 0
C_S_0 core
 20.22336 18.52464 0.69411 0
H_S core
 20.79321 17.95479 1.15831 0
O_S core
 5.63473 7.28127 3.46226 0
C_S_0 core
 5.60864 7.30736 0.69411 0
H_S core
 5.03879 7.87721 1.15831 0
O_S core
 20.19727 7.28127 22.36974 0
C_S_0 core
 20.22336 7.30736 25.13789 0
H_S core
 20.79321 7.87721 24.67369 0
O_S core
 5.63473 18.55073 22.36974 0
C_S_0 core
 5.60864 18.52464 25.13789 0
H_S core
 5.03879 17.95479 24.67369 0
O_S core
 18.55073 22.36974 5.63473 0
C_S_0 core
 18.52464 25.13789 5.60864 0
H_S core
 17.95479 24.67369 5.03879 0
O_S core
 7.28127 22.36974 20.19727 0
C_S_0 core
 7.30736 25.13789 20.22336 0
H_S core
 7.87721 24.67369 20.79321 0
O_S core
 7.28127 3.46226 5.63473 0
C_S_0 core
 7.30736 0.69411 5.60864 0
H_S core
 7.87721 1.15831 5.03879 0
O_S core
 18.55073 3.46226 20.19727 0
C_S_0 core
 18.52464 0.69411 20.22336 0
H_S core
 17.95479 1.15831 20.79321 0
O_S core
 22.36974 20.19727 7.28127 0
C_S_0 core
 25.13789 20.22336 7.30736 0
H_S core
 24.67369 20.79321 7.87721 0
O_S core
 22.36974 5.63473 18.55073 0
C_S_0 core
 25.13789 5.60864 18.52464 0
H_S core
 24.67369 5.03879 17.95479 0
O_S core
 3.46226 20.19727 18.55073 0
C_S_0 core
 0.69411 20.22336 18.52464 0
H_S core
 1.15831 20.79321 17.95479 0
O_S core
 3.46226 5.63473 7.28127 0
C_S_0 core
 0.69411 5.60864 7.30736 0
H_S core
 1.15831 5.03879 7.87721 0
Zn_S core
 7.57859 18.25341 18.25341 0
O_S core
 7.28127 18.55073 16.37826 0
C_S_1 core
 6.458 19.374 15.79213 0
C_S_0 core
 6.458 19.374 14.30654 0
C_S_0 core
 7.30736 18.52464 13.61011 0
H_S core
 7.87721 17.95479 14.07431 0
Zn_S core
 18.25341 7.57859 18.25341 0
O_S core
 18.55073 7.28127 16.37826 0
C_S_1 core
 19.374 6.458 15.79213 0
C_S_0 core
 19.374 6.458 14.30654 0
C_S_0 core
 18.52464 7.30736 13.61011 0
H_S core
 17.95479 7.87721 14.07431 0
Zn_S core
 18.25341 18.25341 7.57859 0
O_S core
 18.55073 18.55073 9.45374 0
C_S_1 core
 19.374 19.374 10.03987 0
C_S_0 core
 19.374 19.374 11.52546 0
C_S_0 core
 18.52464 18.52464 12.22189 0
H_S core
 17.95479 17.95479 11.75769 0
Zn_S core
 7.57859 7.57859 7.57859 0
O_S core
 7.28127 7.28127 9.45374 0
C_S_1 core
 6.458 6.458 10.03987 0
C_S_0 core
 6.458 6.458 11.52546 0
C_S_0 core
 7.30736 7.30736 12.22189 0
H_S core
 7.87721 7.87721 11.75769 0
O_S core
 5.63473 16.37826 20.19727 0
C_S_1 core
 6.458 15.79213 19.374 0
C_S_0 core
 6.458 14.30654 19.374 0
C_S_0 core
 5.60864 13.61011 20.22336 0
H_S core
 5.03879 14.07431 20.79321 0
O_S core
 20.19727 16.37826 5.63473 0
C_S_1 core
 19.374 15.79213 6.458 0
C_S_0 core
 19.374 14.30654 6.458 0
C_S_0 core
 20.22336 13.61011 5.60864 0
H_S core
 20.79321 14.07431 5.03879 0
O_S core
 5.63473 9.45374 5.63473 0
C_S_1 core
 6.458 10.03987 6.458 0
C_S_0 core
 6.458 11.52546 6.458 0
C_S_0 core
 5.60864 12.22189 5.60864 0
H_S core
 5.03879 11.75769 5.03879 0
O_S core
 20.19727 9.45374 20.19727 0
C_S_1 core
 19.374 10.03987 19.374 0
C_S_0 core
 19.374 11.52546 19.374 0
C_S_0 core
 20.22336 12.22189 20.22336 0
H_S core
 20.79321 11.75769 20.79321 0
O_S core
 5.63473 20.19727 9.45374 0
C_S_1 core
 6.458 19.374 10.03987 0
C_S_0 core
 6.458 19.374 11.52546 0
C_S_0 core
 5.60864 20.22336 12.22189 0
H_S core
 5.03879 20.79321 11.75769 0
O_S core
 20.19727 5.63473 9.45374 0
C_S_1 core
 19.374 6.458 10.03987 0
C_S_0 core
 19.374 6.458 11.52546 0
C_S_0 core
 20.22336 5.60864 12.22189 0
H_S core
 20.79321 5.03879 11.75769 0
O_S core
 5.63473 5.63473 16.37826 0
C_S_1 core
 6.458 6.458 15.79213 0
C_S_0 core
 6.458 6.458 14.30654 0
C_S_0 core
 5.60864 5.60864 13.61011 0
H_S core
 5.03879 5.03879 14.07431 0
O_S core
 20.19727 20.19727 16.37826 0
C_S_1 core
 19.374 19.374 15.79213 0
C_S_0 core
 19.374 19.374 14.30654 0
C_S_0 core
 20.22336 20.22336 13.61011 0
H_S core
 20.79321 20.79321 14.07431 0
Zn_S core
 7.57859 18.25341 7.57859 0
O_S core
 7.28127 16.37826 7.28127 0
C_S_1 core
 6.458 15.79213 6.458 0
C_S_0 core
 6.458 14.30654 6.458 0
C_S_0 core
 7.30736 13.61011 7.30736 0
H_S core
 7.87721 14.07431 7.87721 0
Zn_S core
 18.25341 18.25341 18.25341 0
O_S core
 18.55073 16.37826 18.55073 0
C_S_1 core
 19.374 15.79213 19.374 0
C_S_0 core
 19.374 14.30654 19.374 0
C_S_0 core
 18.52464 13.61011 18.52464 0
H_S core
 17.95479 14.07431 17.95479 0
Zn_S core
 18.25341 7.57859 7.57859 0
O_S core
 18.55073 9.45374 7.28127 0
C_S_1 core
 19.374 10.03987 6.458 0
C_S_0 core
 19.374 11.52546 6.458 0
C_S_0 core
 18.52464 12.22189 7.30736 0
H_S core
 17.95479 11.75769 7.87721 0
Zn_S core
 7.57859 7.57859 18.25341 0
O_S core
 7.28127 9.45374 18.55073 0
C_S_1 core
 6.458 10.03987 19.374 0
C_S_0 core
 6.458 11.52546 19.374 0
C_S_0 core
 7.30736 12.22189 18.52464 0
H_S core
 7.87721 11.75769 17.95479 0
O_S core
 18.55073 7.28127 9.45374 0
C_S_0 core
 18.52464 7.30736 12.22189 0
H_S core
 17.95479 7.87721 11.75769 0
O_S core
 7.28127 18.55073 9.45374 0
C_S_0 core
 7.30736 18.52464 12.22189 0
H_S core
 7.87721 17.95479 11.75769 0
O_S core
 7.28127 7.28127 16.37826 0
C_S_0 core
 7.30736 7.30736 13.61011 0
H_S core
 7.87721 7.87721 14.07431 0
O_S core
 18.55073 18.55073 16.37826 0
C_S_0 core
 18.52464 18.52464 13.61011 0
H_S core
 17.95479 17.95479 14.07431 0
O_S core
 20.19727 9.45374 5.63473 0
C_S_0 core
 20.22336 12.22189 5.60864 0
H_S core
 20.79321 11.75769 5.03879 0
O_S core
 5.63473 9.45374 20.19727 0
C_S_0 core
 5.60864 12.22189 20.22336 0
H_S core
 5.03879 11.75769 20.79321 0
O_S core
 20.19727 16.37826 20.19727 0
C_S_0 core
 20.22336 13.61011 20.22336 0
H_S core
 20.79321 14.07431 20.79321 0
O_S core
 5.63473 16.37826 5.63473 0
C_S_0 core
 5.60864 13.61011 5.60864 0
H_S core
 5.03879 14.07431 5.03879 0
O_S core
 20.19727 5.63473 16.37826 0
C_S_0 core
 20.22336 5.60864 13.61011 0
H_S core
 20.79321 5.03879 14.07431 0
O_S core
 5.63473 20.19727 16.37826 0
C_S_0 core
 5.60864 20.22336 13.61011 0
H_S core
 5.03879 20.79321 14.07431 0
O_S core
 20.19727 20.19727 9.45374 0
C_S_0 core
 20.22336 20.22336 12.22189 0
H_S core
 20.79321 20.79321 11.75769 0
O_S core
 5.63473 5.63473 9.45374 0
C_S_0 core
 5.60864 5.60864 12.22189 0
H_S core
 5.03879 5.03879 11.75769 0
O_S core
 18.55073 9.45374 18.55073 0
C_S_0 core
 18.52464 12.22189 18.52464 0
H_S core
 17.95479 11.75769 17.95479 0
O_S core
 7.28127 9.45374 7.28127 0
C_S_0 core
 7.30736 12.22189 7.30736 0
H_S core
 7.87721 11.75769 7.87721 0
O_S core
 7.28127 16.37826 18.55073 0
C_S_0 core
 7.30736 13.61011 18.52464 0
H_S core
 7.87721 14.07431 17.95479 0
O_S core
 18.55073 16.37826 7.28127 0
C_S_0 core
 18.52464 13.61011 7.30736 0
H_S core
 17.95479 14.07431 7.87721 0
O_S core
 16.37826 7.28127 18.55073 0
C_S_1 core
 15.79213 6.458 19.374 0
C_S_0 core
 14.30654 6.458 19.374 0
C_S_0 core
 13.61011 7.30736 18.52464 0
H_S core
 14.07431 7.87721 17.95479 0
O_S core
 16.37826 18.55073 7.28127 0
C_S_1 core
 15.79213 19.374 6.458 0
C_S_0 core
 14.30654 19.374 6.458 0
C_S_0 core
 13.61011 18.52464 7.30736 0
H_S core
 14.07431 17.95479 7.87721 0
O_S core
 9.45374 18.55073 18.55073 0
C_S_1 core
 10.03987 19.374 19.374 0
C_S_0 core
 11.52546 19.374 19.374 0
C_S_0 core
 12.22189 18.52464 18.52464 0
H_S core
 11.75769 17.95479 17.95479 0
O_S core
 9.45374 7.28127 7.28127 0
C_S_1 core
 10.03987 6.458 6.458 0
C_S_0 core
 11.52546 6.458 6.458 0
C_S_0 core
 12.22189 7.30736 7.30736 0
H_S core
 11.75769 7.87721 7.87721 0
O_S core
 16.37826 5.63473 5.63473 0
C_S_1 core
 15.79213 6.458 6.458 0
C_S_0 core
 14.30654 6.458 6.458 0
C_S_0 core
 13.61011 5.60864 5.60864 0
H_S core
 14.07431 5.03879 5.03879 0
O_S core
 16.37826 20.19727 20.19727 0
C_S_1 core
 15.79213 19.374 19.374 0
C_S_0 core
 14.30654 19.374 19.374 0
C_S_0 core
 13.61011 20.22336 20.22336 0
H_S core
 14.07431 20.79321 20.79321 0
O_S core
 9.45374 5.63473 20.19727 0
C_S_1 core
 10.03987 6.458 19.374 0
C_S_0 core
 11.52546 6.458 19.374 0
C_S_0 core
 12.22189 5.60864 20.22336 0
H_S core
 11.75769 5.03879 20.79321 0
O_S core
 9.45374 20.19727 5.63473 0
C_S_1 core
 10.03987 19.374 6.458 0
C_S_0 core
 11.52546 19.374 6.458 0
C_S_0 core
 12.22189 20.22336 5.60864 0
H_S core
 11.75769 20.79321 5.03879 0
O_S core
 9.45374 18.55073 7.28127 0
C_S_0 core
 12.22189 18.52464 7.30736 0
H_S core
 11.75769 17.95479 7.87721 0
O_S core
 9.45374 7.28127 18.55073 0
C_S_0 core
 12.22189 7.30736 18.52464 0
H_S core
 11.75769 7.87721 17.95479 0
O_S core
 16.37826 7.28127 7.28127 0
C_S_0 core
 13.61011 7.30736 7.30736 0
H_S core
 14.07431 7.87721 7.87721 0
O_S core
 16.37826 18.55073 18.55073 0
C_S_0 core
 13.61011 18.52464 18.52464 0
H_S core
 14.07431 17.95479 17.95479 0
O_S core
 9.45374 20.19727 20.19727 0
C_S_0 core
 12.22189 20.22336 20.22336 0
H_S core
 11.75769 20.79321 20.79321 0
O_S core
 9.45374 5.63473 5.63473 0
C_S_0 core
 12.22189 5.60864 5.60864 0
H_S core
 11.75769 5.03879 5.03879 0
O_S core
 16.37826 20.19727 5.63473 0
C_S_0 core
 13.61011 20.22336 5.60864 0
H_S core
 14.07431 20.79321 5.03879 0
O_S core
 16.37826 5.63473 20.19727 0
C_S_0 core
 13.61011 5.60864 20.22336 0
H_S core
 14.07431 5.03879 20.79321 0""")

# Test CONFIG with multiple molecules
config3 = StringIO("""IRMOF1
0 1
25.832 0.0 0.0
0.0 25.832 0.0
0.0 0.0 25.832
NUMMOL 2 1000 1000
MOLECULE IRMOF1 424
Zn_S core
 7.57859 5.33741 5.33741 0
O_Zn core
 6.458 6.458 6.458 0
O_S core
 7.28127 5.63473 3.46226 0
C_S_1 core
 6.458 6.458 2.87613 0
C_S_0 core
 6.458 6.458 1.39054 0
C_S_0 core
 7.30736 5.60864 0.69411 0
H_S core
 7.87721 5.03879 1.15831 0
Zn_S core
 18.25341 20.49459 5.33741 0
O_Zn core
 19.374 19.374 6.458 0
O_S core
 18.55073 20.19727 3.46226 0
C_S_1 core
 19.374 19.374 2.87613 0
C_S_0 core
 19.374 19.374 1.39054 0
C_S_0 core
 18.52464 20.22336 0.69411 0
H_S core
 17.95479 20.79321 1.15831 0
Zn_S core
 18.25341 5.33741 20.49459 0
O_Zn core
 19.374 6.458 19.374 0
O_S core
 18.55073 5.63473 22.36974 0
C_S_1 core
 19.374 6.458 22.95587 0
C_S_0 core
 19.374 6.458 24.44146 0
C_S_0 core
 18.52464 5.60864 25.13789 0
H_S core
 17.95479 5.03879 24.67369 0
Zn_S core
 7.57859 20.49459 20.49459 0
O_Zn core
 6.458 19.374 19.374 0
O_S core
 7.28127 20.19727 22.36974 0
C_S_1 core
 6.458 19.374 22.95587 0
C_S_0 core
 6.458 19.374 24.44146 0
C_S_0 core
 7.30736 20.22336 25.13789 0
H_S core
 7.87721 20.79321 24.67369 0
Zn_S core
 5.33741 7.57859 5.33741 0
O_S core
 3.46226 7.28127 5.63473 0
C_S_1 core
 2.87613 6.458 6.458 0
C_S_0 core
 1.39054 6.458 6.458 0
C_S_0 core
 0.69411 7.30736 5.60864 0
H_S core
 1.15831 7.87721 5.03879 0
Zn_S core
 5.33741 18.25341 20.49459 0
O_S core
 3.46226 18.55073 20.19727 0
C_S_1 core
 2.87613 19.374 19.374 0
C_S_0 core
 1.39054 19.374 19.374 0
C_S_0 core
 0.69411 18.52464 20.22336 0
H_S core
 1.15831 17.95479 20.79321 0
Zn_S core
 20.49459 18.25341 5.33741 0
O_S core
 22.36974 18.55073 5.63473 0
C_S_1 core
 22.95587 19.374 6.458 0
C_S_0 core
 24.44146 19.374 6.458 0
C_S_0 core
 25.13789 18.52464 5.60864 0
H_S core
 24.67369 17.95479 5.03879 0
Zn_S core
 20.49459 7.57859 20.49459 0
O_S core
 22.36974 7.28127 20.19727 0
C_S_1 core
 22.95587 6.458 19.374 0
C_S_0 core
 24.44146 6.458 19.374 0
C_S_0 core
 25.13789 7.30736 20.22336 0
H_S core
 24.67369 7.87721 20.79321 0
Zn_S core
 5.33741 5.33741 7.57859 0
O_S core
 5.63473 3.46226 7.28127 0
C_S_1 core
 6.458 2.87613 6.458 0
C_S_0 core
 6.458 1.39054 6.458 0
C_S_0 core
 5.60864 0.69411 7.30736 0
H_S core
 5.03879 1.15831 7.87721 0
Zn_S core
 20.49459 5.33741 18.25341 0
O_S core
 20.19727 3.46226 18.55073 0
C_S_1 core
 19.374 2.87613 19.374 0
C_S_0 core
 19.374 1.39054 19.374 0
C_S_0 core
 20.22336 0.69411 18.52464 0
H_S core
 20.79321 1.15831 17.95479 0
Zn_S core
 5.33741 20.49459 18.25341 0
O_S core
 5.63473 22.36974 18.55073 0
C_S_1 core
 6.458 22.95587 19.374 0
C_S_0 core
 6.458 24.44146 19.374 0
C_S_0 core
 5.60864 25.13789 18.52464 0
H_S core
 5.03879 24.67369 17.95479 0
Zn_S core
 20.49459 20.49459 7.57859 0
O_S core
 20.19727 22.36974 7.28127 0
C_S_1 core
 19.374 22.95587 6.458 0
C_S_0 core
 19.374 24.44146 6.458 0
C_S_0 core
 20.22336 25.13789 7.30736 0
H_S core
 20.79321 24.67369 7.87721 0
Zn_S core
 5.33741 7.57859 20.49459 0
O_Zn core
 6.458 6.458 19.374 0
O_S core
 5.63473 7.28127 22.36974 0
C_S_1 core
 6.458 6.458 22.95587 0
C_S_0 core
 6.458 6.458 24.44146 0
C_S_0 core
 5.60864 7.30736 25.13789 0
H_S core
 5.03879 7.87721 24.67369 0
Zn_S core
 20.49459 18.25341 20.49459 0
O_Zn core
 19.374 19.374 19.374 0
O_S core
 20.19727 18.55073 22.36974 0
C_S_1 core
 19.374 19.374 22.95587 0
C_S_0 core
 19.374 19.374 24.44146 0
C_S_0 core
 20.22336 18.52464 25.13789 0
H_S core
 20.79321 17.95479 24.67369 0
Zn_S core
 5.33741 18.25341 5.33741 0
O_Zn core
 6.458 19.374 6.458 0
O_S core
 5.63473 18.55073 3.46226 0
C_S_1 core
 6.458 19.374 2.87613 0
C_S_0 core
 6.458 19.374 1.39054 0
C_S_0 core
 5.60864 18.52464 0.69411 0
H_S core
 5.03879 17.95479 1.15831 0
Zn_S core
 20.49459 7.57859 5.33741 0
O_Zn core
 19.374 6.458 6.458 0
O_S core
 20.19727 7.28127 3.46226 0
C_S_1 core
 19.374 6.458 2.87613 0
C_S_0 core
 19.374 6.458 1.39054 0
C_S_0 core
 20.22336 7.30736 0.69411 0
H_S core
 20.79321 7.87721 1.15831 0
Zn_S core
 7.57859 5.33741 20.49459 0
O_S core
 7.28127 3.46226 20.19727 0
C_S_1 core
 6.458 2.87613 19.374 0
C_S_0 core
 6.458 1.39054 19.374 0
C_S_0 core
 7.30736 0.69411 20.22336 0
H_S core
 7.87721 1.15831 20.79321 0
Zn_S core
 18.25341 5.33741 5.33741 0
O_S core
 18.55073 3.46226 5.63473 0
C_S_1 core
 19.374 2.87613 6.458 0
C_S_0 core
 19.374 1.39054 6.458 0
C_S_0 core
 18.52464 0.69411 5.60864 0
H_S core
 17.95479 1.15831 5.03879 0
Zn_S core
 18.25341 20.49459 20.49459 0
O_S core
 18.55073 22.36974 20.19727 0
C_S_1 core
 19.374 22.95587 19.374 0
C_S_0 core
 19.374 24.44146 19.374 0
C_S_0 core
 18.52464 25.13789 20.22336 0
H_S core
 17.95479 24.67369 20.79321 0
Zn_S core
 7.57859 20.49459 5.33741 0
O_S core
 7.28127 22.36974 5.63473 0
C_S_1 core
 6.458 22.95587 6.458 0
C_S_0 core
 6.458 24.44146 6.458 0
C_S_0 core
 7.30736 25.13789 5.60864 0
H_S core
 7.87721 24.67369 5.03879 0
Zn_S core
 5.33741 5.33741 18.25341 0
O_S core
 3.46226 5.63473 18.55073 0
C_S_1 core
 2.87613 6.458 19.374 0
C_S_0 core
 1.39054 6.458 19.374 0
C_S_0 core
 0.69411 5.60864 18.52464 0
H_S core
 1.15831 5.03879 17.95479 0
Zn_S core
 5.33741 20.49459 7.57859 0
O_S core
 3.46226 20.19727 7.28127 0
C_S_1 core
 2.87613 19.374 6.458 0
C_S_0 core
 1.39054 19.374 6.458 0
C_S_0 core
 0.69411 20.22336 7.30736 0
H_S core
 1.15831 20.79321 7.87721 0
Zn_S core
 20.49459 5.33741 7.57859 0
O_S core
 22.36974 5.63473 7.28127 0
C_S_1 core
 22.95587 6.458 6.458 0
C_S_0 core
 24.44146 6.458 6.458 0
C_S_0 core
 25.13789 5.60864 7.30736 0
H_S core
 24.67369 5.03879 7.87721 0
Zn_S core
 20.49459 20.49459 18.25341 0
O_S core
 22.36974 20.19727 18.55073 0
C_S_1 core
 22.95587 19.374 19.374 0
C_S_0 core
 24.44146 19.374 19.374 0
C_S_0 core
 25.13789 20.22336 18.52464 0
H_S core
 24.67369 20.79321 17.95479 0
O_S core
 18.55073 20.19727 22.36974 0
C_S_0 core
 18.52464 20.22336 25.13789 0
H_S core
 17.95479 20.79321 24.67369 0
O_S core
 7.28127 5.63473 22.36974 0
C_S_0 core
 7.30736 5.60864 25.13789 0
H_S core
 7.87721 5.03879 24.67369 0
O_S core
 7.28127 20.19727 3.46226 0
C_S_0 core
 7.30736 20.22336 0.69411 0
H_S core
 7.87721 20.79321 1.15831 0
O_S core
 18.55073 5.63473 3.46226 0
C_S_0 core
 18.52464 5.60864 0.69411 0
H_S core
 17.95479 5.03879 1.15831 0
O_S core
 22.36974 18.55073 20.19727 0
C_S_0 core
 25.13789 18.52464 20.22336 0
H_S core
 24.67369 17.95479 20.79321 0
O_S core
 22.36974 7.28127 5.63473 0
C_S_0 core
 25.13789 7.30736 5.60864 0
H_S core
 24.67369 7.87721 5.03879 0
O_S core
 3.46226 7.28127 20.19727 0
C_S_0 core
 0.69411 7.30736 20.22336 0
H_S core
 1.15831 7.87721 20.79321 0
O_S core
 3.46226 18.55073 5.63473 0
C_S_0 core
 0.69411 18.52464 5.60864 0
H_S core
 1.15831 17.95479 5.03879 0
O_S core
 20.19727 22.36974 18.55073 0
C_S_0 core
 20.22336 25.13789 18.52464 0
H_S core
 20.79321 24.67369 17.95479 0
O_S core
 5.63473 22.36974 7.28127 0
C_S_0 core
 5.60864 25.13789 7.30736 0
H_S core
 5.03879 24.67369 7.87721 0
O_S core
 20.19727 3.46226 7.28127 0
C_S_0 core
 20.22336 0.69411 7.30736 0
H_S core
 20.79321 1.15831 7.87721 0
O_S core
 5.63473 3.46226 18.55073 0
C_S_0 core
 5.60864 0.69411 18.52464 0
H_S core
 5.03879 1.15831 17.95479 0
O_S core
 20.19727 18.55073 3.46226 0
C_S_0 core
 20.22336 18.52464 0.69411 0
H_S core
 20.79321 17.95479 1.15831 0
O_S core
 5.63473 7.28127 3.46226 0
C_S_0 core
 5.60864 7.30736 0.69411 0
H_S core
 5.03879 7.87721 1.15831 0
O_S core
 20.19727 7.28127 22.36974 0
C_S_0 core
 20.22336 7.30736 25.13789 0
H_S core
 20.79321 7.87721 24.67369 0
O_S core
 5.63473 18.55073 22.36974 0
C_S_0 core
 5.60864 18.52464 25.13789 0
H_S core
 5.03879 17.95479 24.67369 0
O_S core
 18.55073 22.36974 5.63473 0
C_S_0 core
 18.52464 25.13789 5.60864 0
H_S core
 17.95479 24.67369 5.03879 0
O_S core
 7.28127 22.36974 20.19727 0
C_S_0 core
 7.30736 25.13789 20.22336 0
H_S core
 7.87721 24.67369 20.79321 0
O_S core
 7.28127 3.46226 5.63473 0
C_S_0 core
 7.30736 0.69411 5.60864 0
H_S core
 7.87721 1.15831 5.03879 0
O_S core
 18.55073 3.46226 20.19727 0
C_S_0 core
 18.52464 0.69411 20.22336 0
H_S core
 17.95479 1.15831 20.79321 0
O_S core
 22.36974 20.19727 7.28127 0
C_S_0 core
 25.13789 20.22336 7.30736 0
H_S core
 24.67369 20.79321 7.87721 0
O_S core
 22.36974 5.63473 18.55073 0
C_S_0 core
 25.13789 5.60864 18.52464 0
H_S core
 24.67369 5.03879 17.95479 0
O_S core
 3.46226 20.19727 18.55073 0
C_S_0 core
 0.69411 20.22336 18.52464 0
H_S core
 1.15831 20.79321 17.95479 0
O_S core
 3.46226 5.63473 7.28127 0
C_S_0 core
 0.69411 5.60864 7.30736 0
H_S core
 1.15831 5.03879 7.87721 0
Zn_S core
 7.57859 18.25341 18.25341 0
O_S core
 7.28127 18.55073 16.37826 0
C_S_1 core
 6.458 19.374 15.79213 0
C_S_0 core
 6.458 19.374 14.30654 0
C_S_0 core
 7.30736 18.52464 13.61011 0
H_S core
 7.87721 17.95479 14.07431 0
Zn_S core
 18.25341 7.57859 18.25341 0
O_S core
 18.55073 7.28127 16.37826 0
C_S_1 core
 19.374 6.458 15.79213 0
C_S_0 core
 19.374 6.458 14.30654 0
C_S_0 core
 18.52464 7.30736 13.61011 0
H_S core
 17.95479 7.87721 14.07431 0
Zn_S core
 18.25341 18.25341 7.57859 0
O_S core
 18.55073 18.55073 9.45374 0
C_S_1 core
 19.374 19.374 10.03987 0
C_S_0 core
 19.374 19.374 11.52546 0
C_S_0 core
 18.52464 18.52464 12.22189 0
H_S core
 17.95479 17.95479 11.75769 0
Zn_S core
 7.57859 7.57859 7.57859 0
O_S core
 7.28127 7.28127 9.45374 0
C_S_1 core
 6.458 6.458 10.03987 0
C_S_0 core
 6.458 6.458 11.52546 0
C_S_0 core
 7.30736 7.30736 12.22189 0
H_S core
 7.87721 7.87721 11.75769 0
O_S core
 5.63473 16.37826 20.19727 0
C_S_1 core
 6.458 15.79213 19.374 0
C_S_0 core
 6.458 14.30654 19.374 0
C_S_0 core
 5.60864 13.61011 20.22336 0
H_S core
 5.03879 14.07431 20.79321 0
O_S core
 20.19727 16.37826 5.63473 0
C_S_1 core
 19.374 15.79213 6.458 0
C_S_0 core
 19.374 14.30654 6.458 0
C_S_0 core
 20.22336 13.61011 5.60864 0
H_S core
 20.79321 14.07431 5.03879 0
O_S core
 5.63473 9.45374 5.63473 0
C_S_1 core
 6.458 10.03987 6.458 0
C_S_0 core
 6.458 11.52546 6.458 0
C_S_0 core
 5.60864 12.22189 5.60864 0
H_S core
 5.03879 11.75769 5.03879 0
O_S core
 20.19727 9.45374 20.19727 0
C_S_1 core
 19.374 10.03987 19.374 0
C_S_0 core
 19.374 11.52546 19.374 0
C_S_0 core
 20.22336 12.22189 20.22336 0
H_S core
 20.79321 11.75769 20.79321 0
O_S core
 5.63473 20.19727 9.45374 0
C_S_1 core
 6.458 19.374 10.03987 0
C_S_0 core
 6.458 19.374 11.52546 0
C_S_0 core
 5.60864 20.22336 12.22189 0
H_S core
 5.03879 20.79321 11.75769 0
O_S core
 20.19727 5.63473 9.45374 0
C_S_1 core
 19.374 6.458 10.03987 0
C_S_0 core
 19.374 6.458 11.52546 0
C_S_0 core
 20.22336 5.60864 12.22189 0
H_S core
 20.79321 5.03879 11.75769 0
O_S core
 5.63473 5.63473 16.37826 0
C_S_1 core
 6.458 6.458 15.79213 0
C_S_0 core
 6.458 6.458 14.30654 0
C_S_0 core
 5.60864 5.60864 13.61011 0
H_S core
 5.03879 5.03879 14.07431 0
O_S core
 20.19727 20.19727 16.37826 0
C_S_1 core
 19.374 19.374 15.79213 0
C_S_0 core
 19.374 19.374 14.30654 0
C_S_0 core
 20.22336 20.22336 13.61011 0
H_S core
 20.79321 20.79321 14.07431 0
Zn_S core
 7.57859 18.25341 7.57859 0
O_S core
 7.28127 16.37826 7.28127 0
C_S_1 core
 6.458 15.79213 6.458 0
C_S_0 core
 6.458 14.30654 6.458 0
C_S_0 core
 7.30736 13.61011 7.30736 0
H_S core
 7.87721 14.07431 7.87721 0
Zn_S core
 18.25341 18.25341 18.25341 0
O_S core
 18.55073 16.37826 18.55073 0
C_S_1 core
 19.374 15.79213 19.374 0
C_S_0 core
 19.374 14.30654 19.374 0
C_S_0 core
 18.52464 13.61011 18.52464 0
H_S core
 17.95479 14.07431 17.95479 0
Zn_S core
 18.25341 7.57859 7.57859 0
O_S core
 18.55073 9.45374 7.28127 0
C_S_1 core
 19.374 10.03987 6.458 0
C_S_0 core
 19.374 11.52546 6.458 0
C_S_0 core
 18.52464 12.22189 7.30736 0
H_S core
 17.95479 11.75769 7.87721 0
Zn_S core
 7.57859 7.57859 18.25341 0
O_S core
 7.28127 9.45374 18.55073 0
C_S_1 core
 6.458 10.03987 19.374 0
C_S_0 core
 6.458 11.52546 19.374 0
C_S_0 core
 7.30736 12.22189 18.52464 0
H_S core
 7.87721 11.75769 17.95479 0
O_S core
 18.55073 7.28127 9.45374 0
C_S_0 core
 18.52464 7.30736 12.22189 0
H_S core
 17.95479 7.87721 11.75769 0
O_S core
 7.28127 18.55073 9.45374 0
C_S_0 core
 7.30736 18.52464 12.22189 0
H_S core
 7.87721 17.95479 11.75769 0
O_S core
 7.28127 7.28127 16.37826 0
C_S_0 core
 7.30736 7.30736 13.61011 0
H_S core
 7.87721 7.87721 14.07431 0
O_S core
 18.55073 18.55073 16.37826 0
C_S_0 core
 18.52464 18.52464 13.61011 0
H_S core
 17.95479 17.95479 14.07431 0
O_S core
 20.19727 9.45374 5.63473 0
C_S_0 core
 20.22336 12.22189 5.60864 0
H_S core
 20.79321 11.75769 5.03879 0
O_S core
 5.63473 9.45374 20.19727 0
C_S_0 core
 5.60864 12.22189 20.22336 0
H_S core
 5.03879 11.75769 20.79321 0
O_S core
 20.19727 16.37826 20.19727 0
C_S_0 core
 20.22336 13.61011 20.22336 0
H_S core
 20.79321 14.07431 20.79321 0
O_S core
 5.63473 16.37826 5.63473 0
C_S_0 core
 5.60864 13.61011 5.60864 0
H_S core
 5.03879 14.07431 5.03879 0
O_S core
 20.19727 5.63473 16.37826 0
C_S_0 core
 20.22336 5.60864 13.61011 0
H_S core
 20.79321 5.03879 14.07431 0
O_S core
 5.63473 20.19727 16.37826 0
C_S_0 core
 5.60864 20.22336 13.61011 0
H_S core
 5.03879 20.79321 14.07431 0
O_S core
 20.19727 20.19727 9.45374 0
C_S_0 core
 20.22336 20.22336 12.22189 0
H_S core
 20.79321 20.79321 11.75769 0
O_S core
 5.63473 5.63473 9.45374 0
C_S_0 core
 5.60864 5.60864 12.22189 0
H_S core
 5.03879 5.03879 11.75769 0
O_S core
 18.55073 9.45374 18.55073 0
C_S_0 core
 18.52464 12.22189 18.52464 0
H_S core
 17.95479 11.75769 17.95479 0
O_S core
 7.28127 9.45374 7.28127 0
C_S_0 core
 7.30736 12.22189 7.30736 0
H_S core
 7.87721 11.75769 7.87721 0
O_S core
 7.28127 16.37826 18.55073 0
C_S_0 core
 7.30736 13.61011 18.52464 0
H_S core
 7.87721 14.07431 17.95479 0
O_S core
 18.55073 16.37826 7.28127 0
C_S_0 core
 18.52464 13.61011 7.30736 0
H_S core
 17.95479 14.07431 7.87721 0
O_S core
 16.37826 7.28127 18.55073 0
C_S_1 core
 15.79213 6.458 19.374 0
C_S_0 core
 14.30654 6.458 19.374 0
C_S_0 core
 13.61011 7.30736 18.52464 0
H_S core
 14.07431 7.87721 17.95479 0
O_S core
 16.37826 18.55073 7.28127 0
C_S_1 core
 15.79213 19.374 6.458 0
C_S_0 core
 14.30654 19.374 6.458 0
C_S_0 core
 13.61011 18.52464 7.30736 0
H_S core
 14.07431 17.95479 7.87721 0
O_S core
 9.45374 18.55073 18.55073 0
C_S_1 core
 10.03987 19.374 19.374 0
C_S_0 core
 11.52546 19.374 19.374 0
C_S_0 core
 12.22189 18.52464 18.52464 0
H_S core
 11.75769 17.95479 17.95479 0
O_S core
 9.45374 7.28127 7.28127 0
C_S_1 core
 10.03987 6.458 6.458 0
C_S_0 core
 11.52546 6.458 6.458 0
C_S_0 core
 12.22189 7.30736 7.30736 0
H_S core
 11.75769 7.87721 7.87721 0
O_S core
 16.37826 5.63473 5.63473 0
C_S_1 core
 15.79213 6.458 6.458 0
C_S_0 core
 14.30654 6.458 6.458 0
C_S_0 core
 13.61011 5.60864 5.60864 0
H_S core
 14.07431 5.03879 5.03879 0
O_S core
 16.37826 20.19727 20.19727 0
C_S_1 core
 15.79213 19.374 19.374 0
C_S_0 core
 14.30654 19.374 19.374 0
C_S_0 core
 13.61011 20.22336 20.22336 0
H_S core
 14.07431 20.79321 20.79321 0
O_S core
 9.45374 5.63473 20.19727 0
C_S_1 core
 10.03987 6.458 19.374 0
C_S_0 core
 11.52546 6.458 19.374 0
C_S_0 core
 12.22189 5.60864 20.22336 0
H_S core
 11.75769 5.03879 20.79321 0
O_S core
 9.45374 20.19727 5.63473 0
C_S_1 core
 10.03987 19.374 6.458 0
C_S_0 core
 11.52546 19.374 6.458 0
C_S_0 core
 12.22189 20.22336 5.60864 0
H_S core
 11.75769 20.79321 5.03879 0
O_S core
 9.45374 18.55073 7.28127 0
C_S_0 core
 12.22189 18.52464 7.30736 0
H_S core
 11.75769 17.95479 7.87721 0
O_S core
 9.45374 7.28127 18.55073 0
C_S_0 core
 12.22189 7.30736 18.52464 0
H_S core
 11.75769 7.87721 17.95479 0
O_S core
 16.37826 7.28127 7.28127 0
C_S_0 core
 13.61011 7.30736 7.30736 0
H_S core
 14.07431 7.87721 7.87721 0
O_S core
 16.37826 18.55073 18.55073 0
C_S_0 core
 13.61011 18.52464 18.52464 0
H_S core
 14.07431 17.95479 17.95479 0
O_S core
 9.45374 20.19727 20.19727 0
C_S_0 core
 12.22189 20.22336 20.22336 0
H_S core
 11.75769 20.79321 20.79321 0
O_S core
 9.45374 5.63473 5.63473 0
C_S_0 core
 12.22189 5.60864 5.60864 0
H_S core
 11.75769 5.03879 5.03879 0
O_S core
 16.37826 20.19727 5.63473 0
C_S_0 core
 13.61011 20.22336 5.60864 0
H_S core
 14.07431 20.79321 5.03879 0
O_S core
 16.37826 5.63473 20.19727 0
C_S_0 core
 13.61011 5.60864 20.22336 0
H_S core
 14.07431 5.03879 20.79321 0
MOLECULE CCl4 5 5
C c
-4.9040312 1.5409769 -11.4603872 0
Cl c
-5.9444069 1.9084828 -9.7399925 0
Cl c
-5.7035198 2.6388140 -12.9877286 0
Cl c
-2.9459550 2.0644262 -11.1974450 0
Cl c
-5.0222431 -0.4478152 -11.9163826 0""")


# Test HISTORY file
hist_test = StringIO("""IRMOF1
0 2 80 EXTRAS 25000 1000 298.0000000 -0.1445003E+05
25.8320000 0.0000000 0.0000000
0.0000000 25.8320000 0.0000000
0.0000000 0.0000000 25.8320000
NUMMOL 16 5000
MOLECULE CCl4 5 5
C c
-4.9040312 1.5409769 -11.4603872 0
Cl c
-5.9444069 1.9084828 -9.7399925 0
Cl c
-5.7035198 2.6388140 -12.9877286 0
Cl c
-2.9459550 2.0644262 -11.1974450 0
Cl c
-5.0222431 -0.4478152 -11.9163826 0
MOLECULE CCl4 5 5
C c
6.6857742 9.6162684 4.3151748 0
Cl c
6.2434545 11.5577685 3.8545985 0
Cl c
8.0511489 9.5707784 5.8353335 0
Cl c
4.9825363 8.6498154 4.9001099 0
Cl c
7.4659572 8.6867112 2.6706573 0
MOLECULE CCl4 5 5
C c
-9.6076007 -1.0324524 -12.6153699 0
Cl c
-8.4414401 -0.3225665 -11.0944060 0
Cl c
-8.6989671 -0.6504529 -14.4058060 0
Cl c
-9.8602466 -3.0487066 -12.3960773 0
Cl c
-11.4297490 -0.1080837 -12.5651904 0
MOLECULE CCl4 5 5
C c
2.0002218 0.1813547 9.3237217 0
Cl c
2.0886417 0.1933654 7.2818506 0
Cl c
2.7522363 1.9381436 10.0485438 0
Cl c
0.0563427 -0.0252462 9.9202535 0
Cl c
3.1036665 -1.3808440 10.0442390 0
MOLECULE CCl4 5 5
C c
-6.7764506 -6.0290831 -11.8480790 0
Cl c
-7.5090229 -4.8597961 -13.3558276 0
Cl c
-6.4289340 -4.8743541 -10.1979175 0
Cl c
-8.1392420 -7.4813009 -11.3886630 0
Cl c
-5.0286034 -6.9008814 -12.4499080 0
MOLECULE CCl4 5 5
C c
-6.0682049 -2.7969752 -6.9507317 0
Cl c
-7.3169189 -1.9572729 -8.3337767 0
Cl c
-6.9706214 -4.4331297 -6.1225754 0
Cl c
-4.3284572 -3.3657885 -7.8600884 0
Cl c
-5.6568220 -1.4317096 -5.4864864 0
MOLECULE CCl4 5 5
C c
0.2753015 3.8603611 12.6123492 0
Cl c
1.9464235 5.0011550 12.3240086 0
Cl c
0.8143774 1.8980565 12.8019738 0
Cl c
-0.6817088 4.4712536 14.3118026 0
Cl c
-0.9778863 4.0709795 11.0116117 0
MOLECULE CCl4 5 5
C c
8.2732792 4.4011767 3.7762004 0
Cl c
7.9044070 6.1251580 4.8101355 0
Cl c
6.6999279 4.0016382 2.5343733 0
Cl c
9.9765053 4.6223531 2.6683638 0
Cl c
8.5122767 2.8555576 5.0919290 0
MOLECULE CCl4 5 5
C c
-0.4948888 -3.9160466 -12.5027801 0
Cl c
0.4130042 -4.1474585 -10.6863609 0
Cl c
-1.9750970 -5.3104704 -12.7071469 0
Cl c
-1.3020156 -2.0424780 -12.6272277 0
Cl c
0.8845532 -4.1637793 -13.9903850 0
MOLECULE CCl4 5 5
C c
-10.3893657 4.5530537 -12.1385914 0
Cl c
-9.0677083 4.1467315 -10.6334921 0
Cl c
-9.4865035 4.2305619 -13.9435953 0
Cl c
-12.0180642 3.3308106 -11.9634821 0
Cl c
-10.9851868 6.5041106 -12.0137962 0
MOLECULE CCl4 5 5
C c
-11.0347731 -4.6073134 -7.0322640 0
Cl c
-9.7188193 -6.1628452 -7.1928457 0
Cl c
-11.9600291 -4.3093383 -8.8301272 0
Cl c
-12.4354112 -5.0439944 -5.6093366 0
Cl c
-10.0248327 -2.9130757 -6.4967465 0
MOLECULE CCl4 5 5
C c
7.6710649 6.9172909 9.6249572 0
Cl c
5.9644815 6.3820812 8.6358546 0
Cl c
7.7183432 8.9478696 9.8523656 0
Cl c
7.7012514 6.0249756 11.4634518 0
Cl c
9.3001833 6.3142370 8.5481568 0
MOLECULE CCl4 5 5
C c
-5.6602485 -4.1403373 -0.0709328 0
Cl c
-4.9865531 -3.3488371 1.6888576 0
Cl c
-7.3685906 -3.1748441 -0.6424132 0
Cl c
-4.2313181 -3.9081050 -1.5136476 0
Cl c
-6.0545320 -6.1295629 0.1834722 0
MOLECULE CCl4 5 5
C c
8.1343097 0.3543623 8.5567016 0
Cl c
8.7615717 -1.2393677 9.6719447 0
Cl c
9.6419029 0.9504651 7.3121037 0
Cl c
6.5080881 -0.1900538 7.4448497 0
Cl c
7.6256758 1.8964055 9.7979084 0
MOLECULE CCl4 5 5
C c
2.5851622 1.8754265 2.1621723 0
Cl c
1.7403128 0.0160482 2.0838020 0
Cl c
2.6622796 2.5073806 4.1043069 0
Cl c
4.4781962 1.7964405 1.3957629 0
Cl c
1.4598602 3.1818367 1.0648174 0
MOLECULE CCl4 5 5
C c
-0.7662106 10.6612158 -2.4279519 0
Cl c
0.4586083 9.1891565 -1.7137670 0
Cl c
0.3514401 12.3029233 -2.9105008 0
Cl c
-1.7416226 9.9877289 -4.0929405 0
Cl c
-2.1332684 11.1650546 -0.9945994 0
IRMOF1
0 2 55 EXTRAS 25000 2000 298.0000000 -0.1127598E+05
25.8320000 0.0000000 0.0000000
0.0000000 25.8320000 0.0000000
0.0000000 0.0000000 25.8320000
NUMMOL 11 5000
MOLECULE CCl4 5 5
C c
-5.1835851 1.1995052 -11.9054527 0
Cl c
-6.2762058 1.6391757 -10.2351025 0
Cl c
-5.8836358 2.2920231 -13.4845454 0
Cl c
-3.2198054 1.6599700 -11.5756933 0
Cl c
-5.3546934 -0.7931480 -12.3264696 0
MOLECULE CCl4 5 5
C c
6.6057708 9.2608310 4.4441692 0
Cl c
6.1942418 11.2543262 4.2602654 0
Cl c
8.0674836 8.9935635 5.8474382 0
Cl c
4.9161626 8.2669241 5.0225922 0
Cl c
7.2451952 8.5285100 2.6463810 0
MOLECULE CCl4 5 5
C c
-2.3913968 1.8546482 7.8245126 0
Cl c
-2.5583584 0.8313059 9.5857890 0
Cl c
-3.6319477 3.4785276 7.8598621 0
Cl c
-0.4604056 2.4777063 7.5790106 0
Cl c
-2.9148757 0.6310532 6.2733889 0
MOLECULE CCl4 5 5
C c
2.6477665 0.4429847 9.1396243 0
Cl c
2.5800932 0.4627440 7.0970206 0
Cl c
3.3396722 2.2433344 9.8157956 0
Cl c
0.7717683 0.1123923 9.8802588 0
Cl c
3.8995324 -1.0465317 9.7654222 0
MOLECULE CCl4 5 5
C c
12.6873324 8.3283476 4.7877430 0
Cl c
11.1130511 7.9641258 3.5362715 0
Cl c
12.4330808 7.2817892 6.5247725 0
Cl c
14.4246506 7.7401946 3.8860770 0
Cl c
12.7785472 10.3272808 5.2038509 0
MOLECULE CCl4 5 5
C c
7.3335442 6.6400104 9.4486902 0
Cl c
5.7984355 6.1552068 8.1894814 0
Cl c
7.4788142 8.6734414 9.5944803 0
Cl c
6.9734489 5.8483752 11.2982429 0
Cl c
9.0834783 5.8830180 8.7125562 0
MOLECULE CCl4 5 5
C c
0.4848719 3.3433453 12.5215511 0
Cl c
2.1176878 4.5531463 12.3036214 0
Cl c
1.0971714 1.4061997 12.7446126 0
Cl c
-0.5731513 3.9178890 14.1731220 0
Cl c
-0.7022204 3.4961460 10.8648484 0
MOLECULE CCl4 5 5
C c
8.3435826 4.3291313 4.3490044 0
Cl c
7.8973895 6.0509392 5.3557264 0
Cl c
6.7901594 3.8398511 3.1142245 0
Cl c
10.0355452 4.6089758 3.2371817 0
Cl c
8.6512363 2.8167592 5.6888848 0
MOLECULE CCl4 5 5
C c
-0.1060575 -3.6926343 12.6158644 0
Cl c
0.7366974 -3.8350333 14.4723898 0
Cl c
-1.5072439 -5.1631670 12.3891260 0
Cl c
-0.9973370 -1.8648747 12.4106430 0
Cl c
1.3436534 -3.9074622 11.1912987 0
MOLECULE CCl4 5 5
C c
4.6924072 -5.1475449 12.7004702 0
Cl c
4.0633828 -3.2940364 13.2887172 0
Cl c
6.6307102 -5.4266450 13.2855210 0
Cl c
3.5087100 -6.5738220 13.5617453 0
Cl c
4.5668256 -5.2956763 10.6658975 0
MOLECULE CCl4 5 5
C c
8.6046816 -7.5388865 7.5130960 0
Cl c
9.9649890 -8.1744663 6.1264446 0
Cl c
8.3788768 -8.9720522 8.9526266 0
Cl c
9.2671921 -5.8074411 8.3735475 0
Cl c
6.8076686 -7.2015864 6.5997654 0
IRMOF1
0 2 70 EXTRAS 25000 3000 298.0000000 -0.1621136E+05
25.8320000 0.0000000 0.0000000
0.0000000 25.8320000 0.0000000
0.0000000 0.0000000 25.8320000
NUMMOL 14 5000
MOLECULE CCl4 5 5
C c
5.6873646 -9.2393714 7.7757682 0
Cl c
7.1325499 -7.9717370 7.0816915 0
Cl c
5.9872958 -11.1055223 6.9981294 0
Cl c
5.7813376 -9.3281034 9.8154975 0
Cl c
3.8482752 -8.5521229 7.2077544 0
MOLECULE CCl4 5 5
C c
6.9350944 9.8059562 5.2445044 0
Cl c
6.4386291 11.7765585 5.0266765 0
Cl c
8.4194017 9.6273678 6.6381105 0
Cl c
5.2939946 8.7537825 5.8584442 0
Cl c
7.5883522 9.0661161 3.4547863 0
MOLECULE CCl4 5 5
C c
-3.4448551 1.0488665 7.6865626 0
Cl c
-3.2356765 0.2880503 9.5719281 0
Cl c
-4.8457924 2.5369096 7.7039456 0
Cl c
-1.6545984 1.8059798 7.0549294 0
Cl c
-4.0433530 -0.4354738 6.4154472 0
MOLECULE CCl4 5 5
C c
2.1392405 0.1858405 9.0503550 0
Cl c
2.1484737 0.1972207 7.0065876 0
Cl c
2.9362033 1.9349940 9.7449860 0
Cl c
0.2180205 -0.0015365 9.7219229 0
Cl c
3.2542646 -1.3873163 9.7279234 0
MOLECULE CCl4 5 5
C c
12.8361541 8.7437645 5.4016298 0
Cl c
11.2482457 8.3564842 4.1745354 0
Cl c
12.5763820 7.7701561 7.1797763 0
Cl c
14.5580243 8.0927263 4.5136476 0
Cl c
12.9619644 10.7556914 5.7385598 0
MOLECULE CCl4 5 5
C c
7.7560160 5.2379760 8.2933067 0
Cl c
6.1202271 4.9386541 7.1051143 0
Cl c
8.0290665 7.2424620 8.5843037 0
Cl c
7.4650915 4.3211679 10.0966441 0
Cl c
9.4096789 4.4496199 7.3871644 0
MOLECULE CCl4 5 5
C c
0.4678216 2.9818547 12.8152954 0
Cl c
2.0795938 4.2258395 12.6367121 0
Cl c
1.1147867 1.0728420 13.1533878 0
Cl c
-0.6953030 3.5942268 14.3803326 0
Cl c
-0.6277912 3.0345106 11.0907491 0
MOLECULE CCl4 5 5
C c
8.6370178 3.8826922 3.2405472 0
Cl c
8.1892155 5.6489968 4.1662044 0
Cl c
7.0704838 3.3183408 2.0553557 0
Cl c
10.3098695 4.1210398 2.0907830 0
Cl c
8.9785024 2.4423915 4.6498456 0
MOLECULE CCl4 5 5
C c
-0.6908541 -2.8937197 12.8483654 0
Cl c
0.3155787 -3.1218065 14.6125280 0
Cl c
-1.9586780 -4.4738366 12.5780818 0
Cl c
-1.7674599 -1.1571496 12.8978053 0
Cl c
0.6471428 -2.8220862 11.3050466 0
MOLECULE CCl4 5 5
C c
4.4822009 -5.2713125 12.0774081 0
Cl c
3.8494888 -3.4285408 12.6947149 0
Cl c
6.3882336 -5.5946148 12.7405180 0
Cl c
3.2431944 -6.7073882 12.8388209 0
Cl c
4.4478867 -5.3547062 10.0355785 0
MOLECULE CCl4 5 5
C c
7.6741831 -1.7654450 6.6368055 0
Cl c
5.9671153 -0.6512426 6.7840217 0
Cl c
7.1836746 -3.7292221 6.3536430 0
Cl c
8.7841579 -1.1052389 5.0527336 0
Cl c
8.7617846 -1.5760765 8.3568237 0
MOLECULE CCl4 5 5
C c
11.4340070 7.7589181 -0.0403410 0
Cl c
11.1024252 9.2477599 -1.4007099 0
Cl c
13.0305695 8.2538777 1.1357557 0
Cl c
9.7742500 7.5220773 1.1285529 0
Cl c
11.8287835 6.0119574 -1.0249628 0
MOLECULE CCl4 5 5
C c
12.6457020 11.3087510 10.3866363 0
Cl c
14.1754643 9.9660787 10.2015459 0
Cl c
11.6732012 11.4843973 8.5976168 0
Cl c
11.3354707 10.6563424 11.8131204 0
Cl c
13.3986718 13.1281856 10.9342621 0
MOLECULE CCl4 5 5
C c
8.0912208 9.0425997 -11.3578373 0
Cl c
8.4069660 7.0901548 -11.8730690 0
Cl c
9.8840856 9.9424203 -10.9664823 0
Cl c
7.1642390 10.0126870 -12.8995361 0
Cl c
6.9095924 9.1251368 -9.6922617 0""")


def test_dlm_config():

    cell1 = np.array([[25.832, 0, 0], [0, 25.832, 0], [0, 0, 25.832]])
    cell2 = np.array([[25.832, 0, 0], [0, 25.832, 0], [0, 0, 25.832]])

    single = read_dlm(config2)
    multiple = read_dlm(config3)

    for i in single:
        assert np.isclose(i[0][1].get_cell(), cell1).all()
        assert i[0][0] == 'IRMOF1'
        assert len(i[0][1]) == 424
    for i in multiple:
        assert np.isclose(i[0][1].get_cell(), cell2).all()
        assert i[0][0] == 'IRMOF1'
        assert len(i[0][1]) == 424


def test_dlm_traj():
    cells = []
    cells.append(np.array([[25.832, 0, 0], [0, 25.832, 0], [0, 0, 25.832]]))
    cells.append(np.array([[25.832, 0, 0], [0, 25.832, 0], [0, 0, 25.832]]))
    cells.append(np.array([[25.832, 0, 0], [0, 25.832, 0], [0, 0, 25.832]]))

    traj = read_dlm_history(hist_test, index=2)
    print(traj)
    assert len(traj) == 1, len(traj)
    assert len(traj[0].keys()) == 14, len(traj[0].keys())
    assert traj[0][0][0] == 'CCl4'
    assert set(traj[0][0][1].numbers) == {6, 17}, traj[0][0][1].numbers

    traj2 = iread_dlm_history(hist_test)

    assert len(list(traj2)) == 3
    num_molecules = [16, 11, 14]
    for count, i in enumerate(traj2):
        assert len(i) == num_molecules[count]
        assert i[0][0] == 'CCl4'
        assert i[0][1].symbols() == 'CCl4'
